"undefined"==typeof public&&(public={}),public.settings={init:function(){$("#form-profile-avatar img, #form-profile-avatar button").on("click",function(){$('#form-profile-avatar-load input[name="avatar"]').click()}),$('#form-profile-avatar-load input[name="avatar"]').on("change",function(){public.settings.avatar()}),$("#setting-form-name").on("submit",function(){public.settings.name()}),$("#setting-form-code-set").on("submit",function(){public.settings.codeSet()}),$("#setting-form-code-upd").on("submit",function(){public.settings.codeUpd()}),$("#setting-form-pass").on("submit",function(){public.settings.pass()}),$("#setting-form-guard").on("submit",function(){public.settings.guard()}),$("#setting-form-privacy").on("submit",function(){public.settings.privacy()}),$('[data-action="confirm-email"]').on("click",function(){var t=$('form.setting-form input[name="email"]').val();return swal({title:lang["confirm-email-title"],text:lang["confirm-email-text"],input:"text",inputAttributes:{maxlength:130,autocomplete:"off",placeholder:lang["confirm-email-plr"],required:!0},inputValue:t,showCancelButton:!0,confirmButtonText:lang["confirm-email-btn1"],cancelButtonText:lang["confirm-email-btn2"],onOpen:function(){swal.getConfirmButton().focus()}}).then(function(t){t.value&&public.settings.confirmEmail(t.value)})}),$("#social-auth").on("click",function(){public.settings.social($(this).prop("checked")?1:0)}),$("[data-delete-social]").on("click",function(){public.settings.socialDelete($(this).attr("data-delete-social"))})},avatar:function(){core.ajax({url:"/users/avatar/files-name/avatar",ident:"avatar",preloader:"#form-profile-avatar button",form:"#form-profile-avatar-load",success:function(t){if(t&&t.error){if(t.error["post-empty"])return swal({type:"error",text:t.error["post-empty"]});if(t.error)return swal({type:"error",text:t.error})}t&&t.success&&$('[data-prop="avatar"]').attr("src","/media/images/avatar/md/"+t.avatar)}})},name:function(){core.ajax({url:"/settings/name",ident:"name",preloader:"#setting-form-name button",form:"#setting-form-name",success:function(t){return t&&t.error?swal({type:"error",text:t.error}):t&&t.success?($('#setting-form-name input[name="name"]').val(t.name),swal({type:"success",text:t.success})):void 0}})},codeSet:function(){core.ajax({url:"/settings/code-set",ident:"code-set",preloader:"#setting-form-code-set button",form:"#setting-form-code-set",success:function(t){return t&&t.error?swal({type:"error",text:t.error}):t&&t.success?($("#setting-form-code-set").after('\t\t\t\t\t\t<form class="setting-form" id="setting-form-code-upd">\t\t\t\t\t\t\t<div class="setting-info">'+lang["code-alredy"]+'</div>\t\t\t\t\t\t\t<div class="form-group mb-0 btn-separator">\t\t\t\t\t\t\t\t<button type="submit" class="btn btn-primary btn-block text-uppercase"><i class="fas fa-lock-open mr-1"></i> '+lang["reset-code"]+"</button>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</form>\t\t\t\t\t").remove(),swal({type:"success",text:t.success})):void 0}})},codeUpd:function(){core.ajax({url:"/settings/code-upd",ident:"code-upd",preloader:"#setting-form-code-upd button",form:"#setting-form-code-upd",success:function(t){return t&&t.error?swal({type:"error",text:t.error}):t&&t.success?swal({type:"success",text:t.success}):void 0}})},pass:function(t){core.ajax({url:"/settings/pass/code/"+(t||0),ident:"pass",preloader:"#setting-form-pass button",form:"#setting-form-pass",success:function(t){return t&&t.code?swal({title:lang["enter-code"],text:lang["continue-code-pass"],input:"text",inputAttributes:{maxlength:4,autocomplete:"off",placeholder:lang["enter-code-plr"],required:!0},showCancelButton:!0,confirmButtonText:lang["enter-code-btn1"],cancelButtonText:lang["confirm-email-btn2"]}).then(function(t){t.value&&public.settings.pass(t.value)}):t&&t.error?swal({type:"error",text:t.error}):t&&t.success?($("#setting-form-pass input").val(""),swal({type:"success",text:t.success})):void 0}})},guard:function(){core.ajax({url:"/settings/guard",ident:"guard",preloader:"#setting-form-guard button",form:"#setting-form-guard",success:function(t){return t&&t.error?swal({type:"error",text:t.error}):t&&t.success?swal({type:"success",text:t.success}):void 0}})},privacy:function(){core.ajax({url:"/settings/privacy",ident:"privacy",preloader:"#setting-form-privacy button",form:"#setting-form-privacy",success:function(t){t&&t.success&&swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})({type:"success",title:t.success})}})},confirmEmail:function(t){$("form#confirmemailhide").length||$("body").append('<form id="confirmemailhide" style="display:none"><input type="hidden" name="email" value=""></form>'),$('form#confirmemailhide input[name="email"]').val(t||""),core.ajax({url:"/users/confirm-email",ident:"confirm-email",form:"#confirmemailhide",success:function(t){return t&&t.error?swal({type:"error",text:t.error}):t&&t.success?($('form.setting-form input[name="email"]').val(t.email),swal({type:"success",text:t.success})):void 0}})},social:function(t){core.ajax({url:"/settings/social/checked/"+t,ident:"social"})},socialDelete:function(e){core.ajax({url:"/settings/social-delete/network/"+e,ident:"social-delete",success:function(t){return t&&t.error?swal({type:"error",text:t.error}):t&&t.success?($('[data-delete-social="'+e+'"]').closest("div").slideUp(200).remove(),swal({type:"success",text:t.success})):void 0}})}},$(document).ready(function(){public.settings.init()});