"undefined"==typeof public&&(public={}),public.adSurfing={init:function(){$('#surf-added form [name="active"], #surf-added form [name="timer"], #surf-added form [name="vip"]').on("change",function(){public.adSurfing.calcAdd()}),$("#surf-added form").on("submit",function(){public.adSurfing.add()}),$(".dt-content").on("click",".col-xl-12.col-lg-6.col-sm-6 [data-id] .ad-surf-desc .settings a",function(){var t=$(this).closest(".surfing-box"),a=t.attr("data-id"),s=t.find(".surf-main .surf-title button"),e=s.html(),r=s.attr("href");$("#surf-settings").attr("data-id",a),$('#surf-settings form [name="title"]').val(e),$('#surf-settings form [name="url"]').val(r),$('#surf-settings form [name="active"] option[value="'+t.attr("data-active")+'"]').prop("selected",!0),$('#surf-settings form [name="timer"] option[value="'+t.attr("data-timer")+'"]').prop("selected",!0),$('#surf-settings form [name="vip"]').prop("checked","1"==t.attr("data-vip")),public.adSurfing.calcEdit()}),$("#surf-settings form").on("submit",function(){public.adSurfing.edit()}),$('#surf-settings form [name="active"], #surf-settings form [name="timer"], #surf-settings form [name="vip"]').on("change",function(){public.adSurfing.calcEdit()}),$(".dt-content").on("click",".col-xl-12.col-lg-6.col-sm-6 [data-id] .ad-surf-info .balance a",function(){var t=$(this).closest(".surfing-box").attr("data-id");$("#surf-refill").attr("data-id",t),public.adSurfing.holdRefill(t)}),$('#surf-refill form [name="amount"]').on("input",function(){public.adSurfing.holdRefill($("#surf-refill").attr("data-id"))}),$("#surf-refill form").on("submit",function(){public.adSurfing.refill()}),$(".dt-content").on("click",".col-xl-12.col-lg-6.col-sm-6 [data-id] .ad-surf-actions a",function(){var t=$(this).closest(".surfing-box").attr("data-id");public.adSurfing.status(t)}),$("#surf-settings .ad-surf-delete-block a").on("click",function(){var t=$("#surf-settings").attr("data-id");return swal({text:lang["confirm-delete-1"]+" «ID: "+t+"»? "+lang["confirm-delete-2"],showCancelButton:!0,confirmButtonText:lang["button-delete"],cancelButtonText:lang["button-cancel"],onOpen:function(){swal.getConfirmButton().focus()}}).then(function(t){t.value&&public.adSurfing.delete()})})},calcAdd:function(){var t=.04;switch("1"==$('#surf-added form [name="active"]').val()&&(t+=.02),$('#surf-added form [name="timer"]').val()){case"30":t+=.01;break;case"40":t+=.02;break;case"50":t+=.03;break;case"60":t+=.04}!0===$('#surf-added form [name="vip"]').prop("checked")&&(t+=.02),$("#surf-added form .end-price span").html(t.toFixed(2))},calcEdit:function(){var t=.04;switch("1"==$('#surf-settings form [name="active"]').val()&&(t+=.02),$('#surf-settings form [name="timer"]').val()){case"30":t+=.01;break;case"40":t+=.02;break;case"50":t+=.03;break;case"60":t+=.04}return!0===$('#surf-settings form [name="vip"]').prop("checked")&&(t+=.02),$("#surf-settings form .end-price span").html(t.toFixed(2)),t.toFixed(2)},add:function(){core.ajax({url:"/serf-sites/add",ident:"add",preloader:"#surf-added form button",form:"#surf-added form",success:function(t){return t&&t.error?swal({type:"error",html:t.error}):t&&t.success?($('#surf-added form [name="title"]').val(""),$('#surf-added form [name="url"]').val(""),$("#surf-added .close").click(),$(".col-lg-12").after('\t\t\t\t\t\t<div class="col-xl-12 col-lg-6 col-sm-6">\t\t\t\t\t\t\t<div class="dt-card surfing-card">\t\t\t\t\t\t\t\t<div class="dt-card__body d-flex ad-surf-box surfing-box'+(t.vip,"")+'" data-id="'+t.id+'" data-active="'+t.active+'" data-timer="'+t.timer+'" data-vip="'+t.vip+'">\t\t\t\t\t\t\t\t\t<div class="ad-surf-actions">\t\t\t\t\t\t\t\t\t\t<a href="javascript:void(0)"><i class="fal fa-play-circle"></i><span>'+lang.playback+'</span></a>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class="surf-main">\t\t\t\t\t\t\t\t\t\t<div class="surf-title">\t\t\t\t\t\t\t\t\t\t\t<img src="https://www.google.com/s2/favicons?domain='+t.url+'">\t\t\t\t\t\t\t\t\t\t\t<a href="'+t.url+'" target="_blank">'+t.title+'</a>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="surf-info ad-surf-desc">\t\t\t\t\t\t\t\t\t\t\t<div class="settings"><i class="far fa-cog"></i><a href="javascript:void(0)" data-toggle="modal" data-target="#surf-settings">'+lang.settings+'</a></div>\t\t\t\t\t\t\t\t\t\t\t<div class="id"><i class="far fa-clipboard-list-check"></i>ID: '+t.id+'</div>\t\t\t\t\t\t\t\t\t\t\t<div class="price"><i class="far fa-wallet"></i>'+lang["cost-one"]+": <span>"+core.main.num(t.amount,4,".")+"</span> "+lang.rub+'</div>\t\t\t\t\t\t\t\t\t\t\t<div class="count"><i class="far fa-eye"></i>'+lang.left+': <span>0</span></div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class="ad-surf-info">\t\t\t\t\t\t\t\t\t\t<div class="balance">'+lang.balance+': <a href="javascript:void(0)" data-toggle="modal" data-target="#surf-refill"><span>0.00</span> '+lang.rub+'</a></div>\t\t\t\t\t\t\t\t\t\t<div class="status">'+lang.status+': <span class="status-1">'+lang["status-pause"]+"</span></div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t"),swal({type:"success",text:t.success})):void 0}})},edit:function(){var t=$("#surf-settings").attr("data-id");core.ajax({url:"/serf-sites/add/id/"+t,ident:"edit",preloader:"#surf-settings form button",form:"#surf-settings form",success:function(t){if(t&&t.error)return swal({type:"error",text:t.error});if(t&&t.success){$('#surf-settings form [name="title"]').val(""),$('#surf-settings form [name="url"]').val(""),$("#surf-settings .close").click();var a=$('.dt-content .col-xl-12.col-lg-6.col-sm-6 [data-id="'+t.id+'"]');return a.find(".surf-main .ad-surf-desc .price span").html(public.adSurfing.calcEdit()),a.find(".surf-main .ad-surf-desc .count span").html(core.main.num(t.hold)),a.attr("data-active",t.active),a.attr("data-timer",t.timer),a.attr("data-vip",t.vip),t.vip?a.addClass("vip"):a.removeClass("vip"),swal({type:"success",text:t.success})}}})},holdRefill:function(t){var a=Number($('#surf-refill form [name="amount"]').val()),s=$('.dt-content .col-xl-12.col-lg-6.col-sm-6 [data-id="'+t+'"]'),e=.04;switch("1"==s.attr("data-active")&&(e+=.02),s.attr("data-timer")){case"30":e+=.01;break;case"40":e+=.02;break;case"50":e+=.03;break;case"60":e+=.04}"1"==s.attr("data-vip")&&(e+=.02),$("#surf-refill form #ad-surf-refill span").html(core.main.num(a/e)+" "+core.main.plural(Number(core.main.num(a/e,0,".","")),lang["view-1"],lang["view-2"],lang["view-5"]))},refill:function(){var e=$("#surf-refill").attr("data-id");core.ajax({url:"/serf-sites/fill/id/"+e,ident:"refill",preloader:"#surf-refill form button",form:"#surf-refill form",success:function(t){if(t&&t.error)return swal({type:"error",text:t.error});if(t&&t.balance)for(var a in t.balance)$('[data-balance="'+a+'"]').html(core.main.num(t.balance[a],2,"."));if(t&&t.success){$('#surf-refill form [name="amount"]').val("100"),public.adSurfing.holdRefill($("#surf-refill").attr("data-id")),$("#surf-refill .close").click();var s=$('.dt-content .col-xl-12.col-lg-6.col-sm-6 [data-id="'+e+'"]');return s.find(".ad-surf-info .balance a span").html(core.main.num(t["balance-site"],2,".")),s.find(".surf-main .surf-info .count span").html(core.main.num(t.hold)),s.find(".ad-surf-actions").html('<a href="javascript:void(0)"><i class="fal fa-pause-circle"></i><span>'+lang.stop+"</span></a>"),s.find(".ad-surf-info .status span").removeClass().addClass("status-2").html(lang["status-play"]),swal({type:"success",text:t.success})}}})},status:function(e){core.ajax({url:"/serf-sites/status/id/"+e,ident:"status",success:function(t){if(t&&t.error)return swal({type:"error",text:t.error});if(t&&t.balance)for(var a in t.balance)$('[data-balance="'+a+'"]').html(core.main.num(t.balance[a],2,"."));if(t&&t.success){var s=$('.dt-content .col-xl-12.col-lg-6.col-sm-6 [data-id="'+e+'"]');return t.status?(s.find(".ad-surf-actions").html('<a href="javascript:void(0)"><i class="fal fa-pause-circle"></i><span>'+lang.stop+"</span></a>"),s.find(".ad-surf-info .status span").removeClass().addClass("status-2").html(lang["status-play"])):(s.find(".ad-surf-actions").html('<a href="javascript:void(0)"><i class="fal fa-play-circle"></i><span>'+lang.playback+"</span></a>"),s.find(".ad-surf-info .status span").removeClass().addClass("status-1").html(lang["status-pause"])),swal({type:"success",text:t.success})}}})},delete:function(){var a=$("#surf-settings").attr("data-id");core.ajax({url:"/serf-sites/delete/id/"+a,ident:"delete",success:function(t){return t&&t.error?swal({type:"error",text:t.error}):t&&t.success?($("#surf-settings .close").click(),$('.dt-content .col-xl-12.col-lg-6.col-sm-6 [data-id="'+a+'"]').closest(".col-xl-12.col-lg-6.col-sm-6").slideUp(500,function(){$(this).remove()}),swal({type:"success",text:t.success})):void 0}})}},$(document).ready(function(){public.adSurfing.init()});